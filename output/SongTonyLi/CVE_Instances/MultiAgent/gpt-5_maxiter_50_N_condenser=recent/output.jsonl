{"instance_id": "wasm3.cve-2022-28966", "timestamp": "20251118_024707", "run_uuid": "5451fa9dd52c4e5cb73db58ec0a6b84c", "model": "openai/gpt-5", "condenser": "recent", "max_iterations": 50, "dataset": "SongTonyLi/CVE_Instances", "split": "cve", "command": "main.py --instance-id wasm3.cve-2022-28966 --model openai/gpt-5 --dataset SongTonyLi/CVE_Instances --split cve", "phase_logs": {"BuilderAgent": ["output/SongTonyLi/CVE_Instances/MultiAgent/gpt-5_maxiter_50_N_condenser=recent/wasm3.cve-2022-28966/20251118_024707/BuilderAgent-7234211b-f0a2-444c-a216-6dab34bb013b.json", "output/SongTonyLi/CVE_Instances/MultiAgent/gpt-5_maxiter_50_N_condenser=recent/wasm3.cve-2022-28966/20251118_024707/BuilderAgent-ef74cc2f-ba4d-40fe-a717-bccd1297e9d6.json"]}, "completions_dir": "output/SongTonyLi/CVE_Instances/MultiAgent/gpt-5_maxiter_50_N_condenser=recent/wasm3.cve-2022-28966/20251118_024707/completions", "instance": {"instance_id": "wasm3.cve-2022-28966", "repo": "wasm3/wasm3", "base_commit": "6b8bcb1e07bf26ebef09a7211b0a37a446eafd52", "date": "2021-06-02T05:40:14", "project_name": "wasm3", "lang": "c++", "dockerfile": "FROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\nRUN git clone https://github.com/wasm3/wasm3 wasm3\nRUN git -C wasm3 checkout 6b8bcb1e07bf26ebef09a7211b0a37a446eafd52\nWORKDIR $SRC/wasm3\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Minimized build script with only core build commands\nset -eu\nmkdir -p build && cd build\ncmake -DBUILD_WASI=none ..\nmake -j$(nproc)", "work_dir": "/src/wasm3", "sanitizer": "address", "bug_description": "================= Bug Report (1/1) ==================\n## Source: GitHub Issue\n## URL: https://github.com/wasm3/wasm3/issues/320\n## Description:\nIssue: wasm3/wasm3#320\nTitle: [security] Heap Overflow in NewCodePage m3_code.c:25:29\nState: closed\nCreated by: zu1k\nCreated at: 2022-04-07 06:41:07+00:00\n\nIssue Body:\nI found a heap overflow vulnerability.\n\nWasm3 0.5.0 has an out-of-bounds write in NewCodePage (called from Compile_BranchTable).\n\nRecommended Security Severity: High\n\nPoc: [poc.zip](https://github.com/wasm3/wasm3/files/8499030/poc.zip)\n\n```\n$ ./wasm3 --func fib poc.wasm\nError: invalid block depth\nfree(): corrupted unsorted chunks\nzsh: IOT instruction (core dumped)  ./wasm3 --func fib poc.wasm\n```\n\nSanitizer: address (ASAN)\n\n```\n$ ./wasm3 --func fib poc.wasm\n=================================================================\n==43773==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000080 at pc 0x55de9111d3b8 bp 0x7ffc6f691a90 sp 0x7ffc6f691a88\nWRITE of size 4 at 0x602000000080 thread T0\n    #0 0x55de9111d3b7 in NewCodePage /disk/wasm3/source/m3_code.c:25:29\n    #1 0x55de9110f4c2 in AcquireCodePageWithCapacity /disk/wasm3/source/m3_env.c:1058:20\n    #2 0x55de910fff78 in EnsureCodePageNumLines /disk/wasm3/source/m3_compile.c:34:28\n    #3 0x55de910b2d8e in Compile_BranchTable /disk/wasm3/source/m3_compile.c:1546:1\n    #4 0x55de910f6b8c in CompileBlockStatements /disk/wasm3/source/m3_compile.c:2608:1\n    #5 0x55de910face1 in CompileFunction /disk/wasm3/source/m3_compile.c:2899:1\n    #6 0x55de9110b1f2 in m3_FindFunction /disk/wasm3/source/m3_env.c:729:1\n    #7 0x55de91096f8c in repl_call /disk/wasm3/platforms/app/main.c:256:23\n    #8 0x55de91099be0 in main /disk/wasm3/platforms/app/main.c:636:26\n    #9 0x7fb47abc730f in __libc_start_call_main libc-start.c\n    #10 0x7fb47abc73c0 in __libc_start_main@GLIBC_2.2.5 (/usr/lib/libc.so.6+0x2d3c0)\n    #11 0x55de90fb1a24 in _start (/disk/wasm3/build/wasm3+0x52a24)\n\n0x602000000080 is located 15 bytes to the right of 1-byte region [0x602000000070,0x602000000071)\nallocated by thread T0 here:\n    #0 0x55de9105c869 in __interceptor_calloc (/disk/wasm3/build/wasm3+0xfd869)\n    #1 0x55de911037a9 in m3_Malloc_Impl /disk/wasm3/source/m3_core.c:129:12\n    #2 0x55de9111d316 in NewCodePage /disk/wasm3/source/m3_code.c:21:25\n    #3 0x55de9110f4c2 in AcquireCodePageWithCapacity /disk/wasm3/source/m3_env.c:1058:20\n    #4 0x55de910fff78 in EnsureCodePageNumLines /disk/wasm3/source/m3_compile.c:34:28\n    #5 0x55de910b2d8e in Compile_BranchTable /disk/wasm3/source/m3_compile.c:1546:1\n    #6 0x55de910f6b8c in CompileBlockStatements /disk/wasm3/source/m3_compile.c:2608:1\n    #7 0x55de910face1 in CompileFunction /disk/wasm3/source/m3_compile.c:2899:1\n    #8 0x55de9110b1f2 in m3_FindFunction /disk/wasm3/source/m3_env.c:729:1\n    #9 0x55de91096f8c in repl_call /disk/wasm3/platforms/app/main.c:256:23\n    #10 0x55de91099be0 in main /disk/wasm3/platforms/app/main.c:636:26\n    #11 0x7fb47abc730f in __libc_start_call_main libc-start.c\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /disk/wasm3/source/m3_code.c:25:29 in NewCodePage\nShadow bytes around the buggy address:\n  0x0c047fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c047fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c047fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c047fff8000: fa fa 00 fa fa fa 04 fa fa fa 00 00 fa fa 01 fa\n=>0x0c047fff8010:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==43773==ABORTING\n```\n\n\nComments:\nComment by zu1k on 2022-04-16 02:25:08+00:00:\n@vshymanskyy Could you please confirm this\uff1f\n\n---\n\nComment by vshymanskyy on 2022-07-12 12:02:16+00:00:\nRelated to #344 ?\n\nAttachments:\nhttps://github.com/wasm3/wasm3/files/8499030/poc.zip", "additional_files": [], "candidate_fixes": []}, "result": {"success": false, "error_message": "Builder phase failed: /bin/sh: 1: cd: can't cd to /src/repo\n", "builder_output": {"phase_type": "BuilderAgent", "success": false, "final_thought": "Build failed", "outputs": {"success": false, "build_exit_code": 2, "build_output": "", "has_commit_hash": true, "final_thought": "Build failed", "error_message": "/bin/sh: 1: cd: can't cd to /src/repo\n"}, "artifacts": {"/src/build.sh": "#!/bin/bash\n# Standalone build script for wasm3 (no fuzz/test steps)\n# - Cleans before configure\n# - Uses all cores for make\n# - Avoids reliance on undefined environment variables\n\nset -e\n\n# Ensure we operate in the repository root\nSRC=\"${SRC:-/src}\"\nREPO_DIR=\"${SRC}/wasm3\"\nif [ -d \"$REPO_DIR\" ]; then\n  cd \"$REPO_DIR\"\nfi\n\n# Ensure required env defaults for the compile wrapper\nexport FUZZING_LANGUAGE=\"${FUZZING_LANGUAGE:-c}\"\n\n# Fresh build directory\nrm -rf build\nmkdir -p build\n\n# Run local preparation scripts if present\nfor s in autogen.sh bootstrap.sh autogen bootstrap; do\n  if [ -f \"$s\" ]; then\n    chmod +x \"$s\" || true\n    ./$s || true\n  fi\ndone\n\n# Configure\ncmake -S . -B build -DBUILD_WASI=none\n\n# Build\ncmake --build build -- -j\"$(nproc)\"\n", "/testcase/base_commit_hash": "6b8bcb1e07bf26ebef09a7211b0a37a446eafd52"}, "error_message": "/bin/sh: 1: cd: can't cd to /src/repo\n", "retry_count": 1}, "exploiter_output": null, "fixer_output": null}}
