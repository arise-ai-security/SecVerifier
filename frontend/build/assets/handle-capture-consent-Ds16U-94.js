import{u as N}from"./QueryClientProvider-DzZUh9st.js";import{u as v}from"./brand-button-Chc-dr4s.js";import{w as T,p as m,o as s,r as g}from"./chunk-BAXFHI7N-C1aCn8M0.js";import{O as f}from"./open-hands--YlJ3f3i.js";import{u as P}from"./auth-context-QvFmluSo.js";import{u as $}from"./use-config-D8tLtqcY.js";import{u as F}from"./open-hands-axios-DmXtiBSx.js";import{I as c}from"./declaration-Be1JuYcO.js";import{u as V}from"./useTranslation-D6EhfAhY.js";import{a as x}from"./chunk-DNIGSRME-C0GitgCW.js";import{l as E,u as q,D as b}from"./use-settings-TDHcUM0x.js";import{c as K}from"./utils-CsA7xLXy.js";import{b as _}from"./module-CmhJwC8X.js";const ue=()=>{const{setProviderTokensSet:e,setProvidersAreSet:r}=P(),a=N(),{data:i}=$(),o=T();return v({mutationFn:async()=>{a.setQueryData(["user"],null),await f.logout((i==null?void 0:i.APP_MODE)??"oss"),a.removeQueries({queryKey:["settings"]}),e([]),r(!1),o("/"),window.location.reload()},onSuccess:()=>{a.invalidateQueries({queryKey:["tasks"]}),a.removeQueries({queryKey:["tasks"]})}})};function M(e){return null}M.getCollectionNode=function*(r){let{children:a,title:i,items:o}=r;yield{type:"section",props:r,hasChildNodes:!0,rendered:i,"aria-label":r["aria-label"],*childNodes(){if(typeof a=="function"){if(!o)throw new Error("props.children was a function but props.items is missing");for(let n of o)yield{type:"item",value:n,renderer:a}}else{let n=[];m.Children.forEach(a,d=>{n.push({type:"item",element:d})}),yield*n}}}};let z=M;var G=z,h=G;const H=async()=>({models:await f.getModels(),agents:await f.getAgents(),securityAnalyzers:await f.getSecurityAnalyzers()}),pe=()=>F({queryKey:["ai-config-options"],queryFn:H,staleTime:1e3*60*5,gcTime:1e3*60*15}),U=e=>!Number.isNaN(Number(e)),A=["openai","azure","anthropic","deepseek"],I=["o3-mini-2025-01-31","o3-2025-04-16","o4-mini-2025-04-16","claude-3-5-sonnet-20241022","claude-3-7-sonnet-20250219","deepseek-chat"],Q=["gpt-4o","gpt-4o-mini","gpt-4-turbo","gpt-4","gpt-4-32k","o1-mini","o1","o3","o3-2025-04-16","o3-mini","o3-mini-2025-01-31","o4-mini","o4-mini-2025-04-16"],B=["claude-2","claude-2.1","claude-3-5-sonnet-20240620","claude-3-5-sonnet-20241022","claude-3-5-haiku-20241022","claude-3-haiku-20240307","claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-7-sonnet-20250219"],W=e=>e[1]&&e[1][0]&&U(e[1][0]),D=e=>{let r="/",a=e.split(r);if(a.length===1&&(r=".",a=e.split(r),W(a)&&(a=[a.join(r)])),a.length===1)return Q.includes(a[0])?{provider:"openai",model:a[0],separator:"/"}:B.includes(a[0])?{provider:"anthropic",model:a[0],separator:"/"}:{provider:"",model:e,separator:""};const[i,...o]=a;return{provider:i,model:o.join(r),separator:r}},me=e=>{const r={};return e.forEach(a=>{const{separator:i,provider:o,model:n}=D(a);if(o==="anthropic"&&i===".")return;const d=o||"other";r[d]||(r[d]={separator:i,models:[]}),r[d].models.push(n)}),r},O={openai:"OpenAI",azure:"Azure",azure_ai:"Azure AI Studio",vertex_ai:"VertexAI",palm:"PaLM",gemini:"Gemini",anthropic:"Anthropic",sagemaker:"AWS SageMaker",bedrock:"AWS Bedrock",mistral:"Mistral AI",anyscale:"Anyscale",databricks:"Databricks",ollama:"Ollama",perlexity:"Perplexity AI",friendliai:"FriendliAI",groq:"Groq",fireworks_ai:"Fireworks AI",cloudflare:"Cloudflare Workers AI",deepinfra:"DeepInfra",ai21:"AI21",replicate:"Replicate",voyage:"Voyage AI",openrouter:"OpenRouter"},R=e=>Object.keys(O).includes(e)?O[e]:e;function fe({isDisabled:e,models:r,currentModel:a}){var C,L;const[,i]=m.useState(null),[o,n]=m.useState(null),[d,y]=m.useState(null);m.useEffect(()=>{if(a){const{provider:t,model:u}=D(a);i(a),n(t),y(u)}},[a]);const k=t=>{var p;n(t),y(null);const u=((p=r[t])==null?void 0:p.separator)||"";i(t+u)},w=t=>{var S;const u=((S=r[o||""])==null?void 0:S.separator)||"";let p=o+u+t;o==="openai"&&(p=t),i(p),y(t)},j=()=>{n(null),i(null)},{t:l}=V();return s.jsxs("div",{className:"flex w-[680px] justify-between gap-[46px]",children:[s.jsxs("fieldset",{className:"flex flex-col gap-2.5 w-full",children:[s.jsx("label",{className:"text-sm",children:l(c.LLM$PROVIDER)}),s.jsxs(x,{"data-testid":"llm-provider-input",isRequired:!0,isVirtualized:!1,name:"llm-provider-input",isDisabled:e,"aria-label":l(c.LLM$PROVIDER),placeholder:l(c.LLM$SELECT_PROVIDER_PLACEHOLDER),isClearable:!1,onSelectionChange:t=>{t!=null&&t.toString()&&k(t.toString())},onInputChange:t=>!t&&j(),defaultSelectedKey:o??void 0,selectedKey:o,classNames:{popoverContent:"bg-tertiary rounded-xl border border-[#717888]"},inputProps:{classNames:{inputWrapper:"bg-tertiary border border-[#717888] h-10 w-full rounded p-2 placeholder:italic"}},children:[s.jsx(h,{title:l(c.MODEL_SELECTOR$VERIFIED),children:Object.keys(r).filter(t=>A.includes(t)).map(t=>s.jsx(E,{"data-testid":`provider-item-${t}`,children:R(t)},t))}),s.jsx(h,{title:l(c.MODEL_SELECTOR$OTHERS),children:Object.keys(r).filter(t=>!A.includes(t)).map(t=>s.jsx(E,{children:R(t)},t))})]})]}),s.jsxs("fieldset",{className:"flex flex-col gap-2.5 w-full",children:[s.jsx("label",{className:"text-sm",children:l(c.LLM$MODEL)}),s.jsxs(x,{"data-testid":"llm-model-input",isRequired:!0,isVirtualized:!1,name:"llm-model-input","aria-label":l(c.LLM$MODEL),placeholder:l(c.LLM$SELECT_MODEL_PLACEHOLDER),isClearable:!1,onSelectionChange:t=>{t!=null&&t.toString()&&w(t.toString())},isDisabled:e||!o,selectedKey:d,defaultSelectedKey:d??void 0,classNames:{popoverContent:"bg-tertiary rounded-xl border border-[#717888]"},inputProps:{classNames:{inputWrapper:"bg-tertiary border border-[#717888] h-10 w-full rounded p-2 placeholder:italic"}},children:[s.jsx(h,{title:l(c.MODEL_SELECTOR$VERIFIED),children:(C=r[o||""])==null?void 0:C.models.filter(t=>I.includes(t)).map(t=>s.jsx(E,{children:t},t))}),s.jsx(h,{title:l(c.MODEL_SELECTOR$OTHERS),children:(L=r[o||""])==null?void 0:L.models.filter(t=>!I.includes(t)).map(t=>s.jsx(E,{"data-testid":`model-item-${t}`,children:t},t))})]})]})]})}const Z=e=>g.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},g.createElement("path",{d:"M9.9509 15.588H10.8349L16.5125 9.91042L15.6285 9.0264L10.3991 14.2681L8.00867 11.8777L7.12465 12.7617L9.9509 15.588Z",fill:"currentColor"}),g.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.8521 3.29895C14.8443 3.42346 16.712 4.41954 18.0816 5.78916C19.7002 7.53231 20.5718 9.64898 20.5718 12.1392C20.5718 14.1314 19.8247 15.999 18.5796 17.6177C17.3345 19.1118 15.5914 20.2324 13.5992 20.6059C11.607 20.9794 9.61486 20.7304 7.87171 19.7343C6.12856 18.7382 4.75895 17.2441 4.01189 15.3765C3.26482 13.5088 3.14031 11.3921 3.76286 9.52447C4.38542 7.53231 5.50601 5.91367 7.24916 4.79308C8.86779 3.67248 10.86 3.17444 12.8521 3.29895ZM13.4747 19.3608C15.0933 18.9873 16.5874 18.1157 17.708 16.7461C18.7041 15.3765 19.3267 13.7578 19.2022 12.0147C19.2022 10.0225 18.4551 8.03035 17.0855 6.66073C15.8404 5.41563 14.3463 4.66857 12.6031 4.54405C10.9845 4.41954 9.24132 4.79308 7.87171 5.78916C6.50209 6.78524 5.50601 8.15486 5.00797 9.89801C4.50993 11.5166 4.50993 13.2598 5.25699 14.8784C6.00405 16.4971 7.12465 17.7422 8.61877 18.6137C10.1129 19.4853 11.856 19.7343 13.4747 19.3608Z",fill:"currentColor"}));function Ee({isSet:e}){return s.jsx("span",{"data-testid":e?"set-indicator":"unset-indicator",children:s.jsx(Z,{className:K(e?"text-success":"text-danger")})})}function _e({testId:e,text:r,linkText:a,href:i}){return s.jsxs("p",{"data-testid":e,className:"text-xs",children:[r," ",s.jsx("a",{href:i,rel:"noreferrer noopener",target:"_blank",className:"underline underline-offset-2",children:a})]})}const Y=async e=>{var a;const r={llm_model:e.LLM_MODEL,llm_base_url:e.LLM_BASE_URL,agent:e.AGENT||b.AGENT,language:e.LANGUAGE||b.LANGUAGE,confirmation_mode:e.CONFIRMATION_MODE,security_analyzer:e.SECURITY_ANALYZER,llm_api_key:e.llm_api_key===""?"":((a=e.llm_api_key)==null?void 0:a.trim())||void 0,remote_runtime_resource_factor:e.REMOTE_RUNTIME_RESOURCE_FACTOR,enable_default_condenser:e.ENABLE_DEFAULT_CONDENSER,enable_sound_notifications:e.ENABLE_SOUND_NOTIFICATIONS,user_consents_to_analytics:e.user_consents_to_analytics,provider_tokens:e.provider_tokens};await f.saveSettings(r)},he=()=>{const e=N(),{data:r}=q();return v({mutationFn:async a=>{const i={...r,...a};await Y(i)},onSuccess:async()=>{await e.invalidateQueries({queryKey:["settings"]})},meta:{disableToast:!0}})},ye=e=>{e&&!_.has_opted_in_capturing()&&_.opt_in_capturing(),!e&&!_.has_opted_out_capturing()&&_.opt_out_capturing()};export{_e as H,Ee as K,fe as M,he as a,pe as b,D as e,ye as h,me as o,ue as u};
