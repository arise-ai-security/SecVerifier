import{j as t,w as ae,R as o}from"./chunk-ZYFC6VSF-CV8XXl5-.js";import{u as ne}from"./use-save-settings-Bua0aP3f.js";import{u as ie,D as I}from"./use-settings-Ds8Eg1n4.js";import{A as u}from"./index-C9Z42wpF.js";import{B as oe}from"./brand-button-BwmgTwuO.js";import{I as le,S as g}from"./input-skeleton-BoPFuPdN.js";import{S as T}from"./settings-input-CBXw9VoS.js";import{I as i}from"./declaration-CSyN0VgG.js";import{S as re}from"./settings-dropdown-input-mr_tSlFW.js";import{u as y}from"./useTranslation-mdJfIcDH.js";import{h as ce}from"./handle-capture-consent-GXZm-FX0.js";import{a as Se,d as ge}from"./custom-toast-handlers-BD_JVnrP.js";import{r as ue}from"./retrieve-axios-error-message-CYr77e_f.js";import{S as G}from"./switch-skeleton-BPZBJysA.js";import{u as de}from"./use-config-Cu-DTsjW.js";import{p as L}from"./settings-utils-C--CGkWg.js";import"./open-hands-axios-BHmDa7Dt.js";import"./module-D8R257Cm.js";import"./open-hands-C0cV1FsE.js";import"./useQuery-BQp87qj0.js";import"./i18next-CO45VQzB.js";import"./preload-helper-BXl3LOEh.js";import"./i18nInstance-DBIXdvxg.js";import"./mutation-CyON2C4n.js";import"./utils-ortCDxR2.js";import"./optional-tag-D6E6pm99.js";import"./chunk-S6H5EOGR-Dp_maNhv.js";import"./index-B3bthoHG.js";import"./index-DnvoE-Td.js";import"./index-DuWOChOE.js";import"./map-provider-g8SgAMsv.js";function me({defaultKey:n,onChange:d,name:l}){const{t:s}=y();return t.jsx(re,{testId:l,name:l,onInputChange:d,label:s(i.SETTINGS$LANGUAGE),items:u.map(c=>({key:c.value,label:c.label})),defaultSelectedKey:n,isClearable:!1,wrapperClassName:"w-full max-w-[680px]"})}function Ie(){return t.jsxs("div",{"data-testid":"app-settings-skeleton",className:"px-11 py-9 flex flex-col gap-6",children:[t.jsx(le,{}),t.jsx(G,{}),t.jsx(G,{})]})}function Te(){const{t:n}=y(),{mutate:d,isPending:l}=ne(),{data:s,isLoading:c}=ie(),{data:p}=de(),[w,E]=o.useState(!1),[O,A]=o.useState(!1),[R,N]=o.useState(!1),[U,h]=o.useState(!1),[v,B]=o.useState(!1),[j,f]=o.useState(!1),[V,_]=o.useState(!1),[H,C]=o.useState(!1),M=e=>{const a=e.get("language-input")?.toString(),r=u.find(({label:m})=>m===a)?.value||I.LANGUAGE,b=e.get("enable-analytics-switch")?.toString()==="on",z=e.get("enable-sound-notifications-switch")?.toString()==="on",J=e.get("enable-proactive-conversations-switch")?.toString()==="on",Q=e.get("enable-solvability-analysis-switch")?.toString()==="on",W=e.get("max-budget-per-task-input")?.toString(),Z=L(W||""),ee=e.get("git-user-name-input")?.toString()||I.GIT_USER_NAME,te=e.get("git-user-email-input")?.toString()||I.GIT_USER_EMAIL;d({LANGUAGE:r,user_consents_to_analytics:b,ENABLE_SOUND_NOTIFICATIONS:z,ENABLE_PROACTIVE_CONVERSATION_STARTERS:J,ENABLE_SOLVABILITY_ANALYSIS:Q,MAX_BUDGET_PER_TASK:Z,GIT_USER_NAME:ee,GIT_USER_EMAIL:te},{onSuccess:()=>{ce(b),ge(n(i.SETTINGS$SAVED))},onError:m=>{const se=ue(m);Se(se||n(i.ERROR$GENERIC))},onSettled:()=>{E(!1),A(!1),N(!1),h(!1),f(!1),_(!1),C(!1)}})},P=e=>{const a=u.find(({label:r})=>r===e)?.label,S=u.find(({value:r})=>r===s?.LANGUAGE)?.label;E(a!==S)},k=e=>{const a=!!s?.USER_CONSENTS_TO_ANALYTICS;A(e!==a)},$=e=>{const a=!!s?.ENABLE_SOUND_NOTIFICATIONS;N(e!==a)},D=e=>{const a=!!s?.ENABLE_PROACTIVE_CONVERSATION_STARTERS;h(e!==a)},Y=e=>{const a=!!s?.ENABLE_SOLVABILITY_ANALYSIS;B(e!==a)},K=e=>{const a=L(e),S=s?.MAX_BUDGET_PER_TASK;f(a!==S)},F=e=>{const a=s?.GIT_USER_NAME;_(e!==a)},X=e=>{const a=s?.GIT_USER_EMAIL;C(e!==a)},q=!w&&!O&&!R&&!U&&!v&&!j&&!V&&!H,x=!s||c||l;return t.jsxs("form",{"data-testid":"app-settings-screen",action:M,className:"flex flex-col h-full justify-between",children:[x&&t.jsx(Ie,{}),!x&&t.jsxs("div",{className:"p-9 flex flex-col gap-6",children:[t.jsx(me,{name:"language-input",defaultKey:s.LANGUAGE,onChange:P}),t.jsx(g,{testId:"enable-analytics-switch",name:"enable-analytics-switch",defaultIsToggled:!!s.USER_CONSENTS_TO_ANALYTICS,onToggle:k,children:n(i.ANALYTICS$SEND_ANONYMOUS_DATA)}),t.jsx(g,{testId:"enable-sound-notifications-switch",name:"enable-sound-notifications-switch",defaultIsToggled:!!s.ENABLE_SOUND_NOTIFICATIONS,onToggle:$,children:n(i.SETTINGS$SOUND_NOTIFICATIONS)}),p?.APP_MODE==="saas"&&t.jsx(g,{testId:"enable-proactive-conversations-switch",name:"enable-proactive-conversations-switch",defaultIsToggled:!!s.ENABLE_PROACTIVE_CONVERSATION_STARTERS,onToggle:D,children:n(i.SETTINGS$PROACTIVE_CONVERSATION_STARTERS)}),p?.APP_MODE==="saas"&&t.jsx(g,{testId:"enable-solvability-analysis-switch",name:"enable-solvability-analysis-switch",defaultIsToggled:!!s.ENABLE_SOLVABILITY_ANALYSIS,onToggle:Y,children:n(i.SETTINGS$SOLVABILITY_ANALYSIS)}),t.jsx(T,{testId:"max-budget-per-task-input",name:"max-budget-per-task-input",type:"number",label:n(i.SETTINGS$MAX_BUDGET_PER_CONVERSATION),defaultValue:s.MAX_BUDGET_PER_TASK?.toString()||"",onChange:K,placeholder:n(i.SETTINGS$MAXIMUM_BUDGET_USD),min:1,step:1,className:"w-full max-w-[680px]"}),t.jsxs("div",{className:"border-t border-t-tertiary pt-6 mt-2 hidden",children:[t.jsx("h3",{className:"text-lg font-medium mb-2",children:n(i.SETTINGS$GIT_SETTINGS)}),t.jsx("p",{className:"text-sm text-secondary mb-4",children:n(i.SETTINGS$GIT_SETTINGS_DESCRIPTION)}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx(T,{testId:"git-user-name-input",name:"git-user-name-input",type:"text",label:n(i.SETTINGS$GIT_USERNAME),defaultValue:s.GIT_USER_NAME||"",onChange:F,placeholder:"Username for git commits",className:"w-full max-w-[680px]"}),t.jsx(T,{testId:"git-user-email-input",name:"git-user-email-input",type:"email",label:n(i.SETTINGS$GIT_EMAIL),defaultValue:s.GIT_USER_EMAIL||"",onChange:X,placeholder:"Email for git commits",className:"w-full max-w-[680px]"})]})]})]}),t.jsx("div",{className:"flex gap-6 p-6 justify-end border-t border-t-tertiary",children:t.jsxs(oe,{testId:"submit-button",variant:"primary",type:"submit",isDisabled:l||q,children:[!l&&n("SETTINGS$SAVE_CHANGES"),l&&n("SETTINGS$SAVING")]})})]})}const qe=ae(Te);export{qe as default};
